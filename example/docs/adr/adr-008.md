# ADR 008 - Utilisation d'une stratégie de cache hybride

## Statut
Acceptée

## Contexte
Afin d'optimiser la performance du système, celui-ci doit mettre en place un cache pour les endpoints critiques, ce qui permet de réduire le temps des requêtes et épargner des ressources physiques sur l'architecture.

## Décision
Le moteur d'appariement utilisera la stratégie "Write-Behind" et le reste du système utilisera la stratégie "Cache-Aside".

## Conséquences
La stratégie "Write-Behind" écrit les données dans le cache directement et dans la base de données plus tard. Cette stratégie offre une vitesse de lecture rapide, une complexité d'écriture moyenne et est idéale pour les systèmes qui doivent effectuer beaucoup d'opérations d'écriture. Étant donné que le moteur d'appariement doit effectuer des mises à jour rapidement sur les ordres, il est essentiel que ces opérations soit fait rapidement. De plus, le fait de lire le cache directement améliore les performances de lecture. Cette stratégie entraine un risque de perte de données puisque la base de données n'est pas mise à jour instantanement. Par contre, ce risque peut être contré avec des solutions comme Redis with AOF (append only file). \

La stratégie "Cache-Aside" met à jour le cache seulement lorsqu'il y a des caches miss. Cela permet de garder en cache seulement les données qui sont demandés par le reste du système ce qui permet de ne pas remplir le cache pour rien. Le désavantage de cette stratégie est que la première requête pour obtenir une donnée sera plus lente que les suivantes, puisqu'il y aura forcément un cache miss. Finalement, cette stratégie est adapté pour le service d'instruments et des portfolios car elle est simple à implémenter et offre des gains de performances immédiats.